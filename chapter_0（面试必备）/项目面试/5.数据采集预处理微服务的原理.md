**面试官**：请简述数据采集与传输模块的架构设计。  
**候选人**：  
该模块采用分层架构设计，核心目标是实现**高可靠、低延迟、高吞吐**的工业数据采集与传输。以下是核心分层及关键设计：

---

#### **1. 数据采集层**
- **技术栈**：Golang微服务 + Modbus/TCP协议
- **核心职责**：
   - 在边缘侧（油井现场）部署轻量级采集服务，通过Modbus协议实时获取传感器数据（压力、温度、流量等）。
   - 实现协议适配层，支持多厂商设备的不同通信规约。
   - 数据预处理：进行基础校验（如范围校验、空值过滤），剔除异常数据（如负压力值），降低无效数据传输。

---

#### **2. 数据传输层**
- **技术栈**：RabbitMQ + Protocol Buffers
- **核心设计**：
   - **序列化优化**：使用Protobuf进行二进制编码，相比JSON减少60%传输体积。
   - **消息路由**：通过RabbitMQ的Topic Exchange实现数据分类路由（如`/sensor/pressure`、`/sensor/temperature`），支持多消费者组并行处理。
   - **可靠性保障**：
      - 消息持久化（Delivery Mode=2）与镜像队列，确保服务重启后数据不丢失。
      - 消费者侧手动ACK机制，仅在业务处理成功后确认消息，避免数据丢失。

---

#### **3. 容错与缓冲层**
- **技术栈**：Redis + 断网检测机制
- **核心机制**：
   - **本地缓存**：当网络中断时，采集服务自动将数据写入Redis持久化存储，最大缓存24小时数据（基于LRU策略）。
   - **自动重传**：网络恢复后，通过后台协程自动补传缓存数据，补传过程优先处理最新数据以保障时效性。

---

#### **4. 运维支撑层**
- **监控体系**：
   - **指标监控**：通过Prometheus采集服务的CPU/内存使用率、消息处理速率、网络延迟等指标，Grafana实现实时可视化。
   - **告警规则**：定义业务级告警（如持续5分钟采集失败率>1%），对接企业微信通知。
- **日志管理**：
   - Filebeat收集服务日志，传输至Elasticsearch集群，通过Kibana提供日志检索与聚合分析能力。

---

#### **5. 性能优化策略**
- **批量传输**：采集服务按时间窗口（如200ms）或数据量阈值（如500条）批量发送数据，减少网络IO次数。
- **压缩传输**：对Protobuf序列化后的数据进一步采用Snappy压缩，降低带宽占用30%以上。
- **资源隔离**：对压力/温度等不同数据类型分配独立RabbitMQ队列，避免单一队列拥堵影响全局。

---

#### **架构成效**
- **吞吐能力**：单节点支持8万条/秒数据采集，集群可扩展至50万条/秒。
- **端到端延迟**：95%的数据在500ms内完成采集到下游处理。
- **可靠性**：在全年网络平均故障率2%的情况下，实现数据零丢失。

---

**面试官**：这个架构的关键技术决策是什么？  
**候选人**：  
三个核心决策：
1. **边缘计算与云端协同**：在边缘侧完成数据过滤与压缩，降低带宽消耗。
2. **分级可靠性设计**：Redis实现短时故障容忍，RabbitMQ保障长期可靠传输。
3. **协议级优化**：通过Protobuf+Snappy组合优化，在序列化效率和可读性之间取得平衡。